---
title: 4.6 å¾®æœåŠ¡æ•æ·å¼€å‘æœ€ä½³å®è·µ
keywords: [ SCA ]
description: å¦‚ä½•ä½æˆæœ¬ç©è½¬æ•æ·å¼€å‘ä»€ä¹ˆæ˜¯ MSE å¼€å‘ç¯å¢ƒéš”ç¦»ï¼Œç®€å•åœ°è¯´å°±æ˜¯å°† feature ç¯å¢ƒçš„éš”ç¦»æ–¹å¼ä»ç®€å•çš„ç‰©ç†éš”ç¦»è½¬ä¸ºé€»è¾‘éš”ç¦»ã€‚å€ŸåŠ©äº MSE æä¾›çš„é€»è¾‘éš”ç¦»ï¼Œæ‚¨åªéœ€è¦ç»´æŠ¤ä¸€å¥—å®Œæ•´çš„åŸºçº¿ç¯å¢ƒï¼Œåœ¨å¢åŠ  feature ç¯å¢ƒæ—¶ï¼Œåªéœ€è¦å•ç‹¬éƒ¨ç½²è¿™ä¸ª feature æ‰€æ¶‰åŠåˆ°æ”¹åŠ¨çš„åº”ç”¨å³å¯ï¼Œè€Œä¸éœ€è¦åœ¨...
---

<a name="xCEGK"></a>
### å¦‚ä½•ä½æˆæœ¬ç©è½¬æ•æ·å¼€å‘

ä»€ä¹ˆæ˜¯ MSE å¼€å‘ç¯å¢ƒéš”ç¦»ï¼Œç®€å•åœ°è¯´å°±æ˜¯å°† feature ç¯å¢ƒçš„éš”ç¦»æ–¹å¼ä»ç®€å•çš„ç‰©ç†éš”ç¦»è½¬ä¸ºé€»è¾‘éš”ç¦»ã€‚å€ŸåŠ©äº MSE æä¾›çš„é€»è¾‘éš”ç¦»ï¼Œæ‚¨åªéœ€è¦ç»´æŠ¤ä¸€å¥—å®Œæ•´çš„åŸºçº¿ç¯å¢ƒï¼Œåœ¨å¢åŠ  feature ç¯å¢ƒæ—¶ï¼Œåªéœ€è¦å•ç‹¬éƒ¨ç½²è¿™ä¸ª feature æ‰€æ¶‰åŠåˆ°æ”¹åŠ¨çš„åº”ç”¨å³å¯ï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ª feature ç¯å¢ƒéƒ½éƒ¨ç½²æ•´å¥—çš„å¾®æœåŠ¡åº”ç”¨åŠå…¶é…å¥—è®¾æ–½ã€‚

æˆ‘ä»¬ç§°ä¹‹è¿™å”¯ä¸€çš„ä¸€å¥—å®Œæ•´çš„ç¯å¢ƒä¸ºåŸºçº¿ç¯å¢ƒã€‚åŸºçº¿ç¯å¢ƒåŒ…å«äº†æ‰€æœ‰å¾®æœåŠ¡åº”ç”¨ï¼Œä¹ŸåŒ…å«äº†æœåŠ¡æ³¨å†Œä¸­å¿ƒã€åŸŸåã€SLBã€ç½‘å…³ ç­‰å…¶ä»–è®¾æ–½ï¼Œè€Œ feature ç¯å¢ƒä¸­åªåŒ…å«äº†è¿™ä¸ª feature ä¸­éœ€è¦ä¿®æ”¹çš„åº”ç”¨ã€‚è¿™æ ·ç»´æŠ¤ n å¥— feature ç¯å¢ƒçš„æˆæœ¬ï¼Œå°±å˜æˆäº†åŠ æ³•ï¼Œè€Œä¸æ˜¯åŸæ¥çš„ä¹˜æ³•ï¼Œç”± n Ã— m å˜æˆäº†  n ï¼‹  mã€‚**å·®ä¸å¤šç›¸å½“äºé›¶æˆæœ¬å¢åŠ  feature ç¯å¢ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒåœ°æ‰©å®¹å‡ºå¤šå¥— feature ç¯å¢ƒï¼Œæ¯ä¸ªå¼€å‘å°å“¥å“¥éƒ½å¯ä»¥è½»æ¾æ‹¥æœ‰å±äºè‡ªå·±çš„ç‹¬ç«‹ç¯å¢ƒï¼Œå°½æƒ…åœ°äº«å—å¾®æœåŠ¡æ•æ·å¼€å‘ã€‚**<br />![æ¶æ„å›¾_4-6-1 ç¬¬å››ç« ç¬¬å…­èŠ‚ç¬¬ä¸€å¼ å›¾.jpg](https://intranetproxy.alipay.com/skylark/lark/0/2022/jpeg/54319/1648207236200-4f3a510f-5262-449a-a22f-95d3ad9324bb.jpeg#clientId=ude73ab61-b4c0-4&from=ui&id=u61417056&originHeight=1844&originWidth=3308&originalType=binary&ratio=1&rotation=0&showTitle=false&size=265374&status=done&style=none&taskId=ub1c69d35-fb40-417f-a87e-ea1dd1b5e64&title=)


ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œfeature1 å¯¹åº”çš„æµé‡ï¼Œåœ¨å‘ç° feature1 ä¸­å­˜åœ¨ A1 åº”ç”¨æ—¶ï¼Œä¸€å®šä¼šå»å¾€ A1 èŠ‚ç‚¹ï¼ŒA1åœ¨è°ƒç”¨Bçš„æ—¶å€™å‘ç° feature1 ç¯å¢ƒä¸­ä¸å­˜åœ¨ B1 ï¼Œåˆ™ä¼šå°†è¯·æ±‚å‘åˆ° åŸºçº¿ç‰ˆæœ¬çš„ B ä¸­ï¼›Båœ¨è°ƒç”¨Cæ—¶ï¼Œå‘ç° feature1 ç¯å¢ƒå­˜åœ¨ C1 åº”ç”¨ï¼Œåˆä¼šè¿”å›åˆ° feature1 ç¯å¢ƒä¸­ï¼Œä¾æ¬¡ç±»æ¨ï¼Œç¡®ä¿äº†æµé‡ä¼šåœ¨ feature1 ç¯å¢ƒä¸­é—­ç¯ã€‚<br />**è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¡ç®—ä¸€ä¸‹è¿™å¥—æ–¹æ¡ˆçš„æˆæœ¬ï¼Œ10ä¸ªèŠ‚ç‚¹ä½¿ç”¨ mse ä¸“ä¸šç‰ˆï¼Œä¸€å¹´çš„æˆæœ¬æ˜¯ 0.4 * 24 * 365 * 10 = 3504ï¼Œæ€»æˆæœ¬å°±æ˜¯16800 + 3504ï¼Œå·®ä¸å¤šæ˜¯2ä¸‡å…ƒï¼Œä½¿ç”¨ MSE èƒ½èŠ‚çœ 4 ä¸‡å¤šçš„æˆæœ¬ï¼Œè€Œä¸”ä½ çš„å¼€å‘ç¯å¢ƒå’Œåº”ç”¨è¶Šå¤šï¼ŒèŠ‚çœçš„æˆæœ¬è¶Šå¤šã€‚**<br />**è€Œä¸”ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ‚¨ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç å’Œé…ç½®ï¼Œç›´æ¥æ¥å…¥ MSE å¾®æœåŠ¡æ²»ç†å³å¯ä½¿ç”¨ï¼Œä¸ä¼šç»™æ‚¨å¢åŠ ä»»ä½•å¼€å‘æˆæœ¬ã€‚**

<a name="HIO9P"></a>
## å¦‚ä½•ä½¿ç”¨ MSE **å¼€å‘ç¯å¢ƒéš”ç¦»**

<a name="hUfGd"></a>
### åœºæ™¯åˆ†æ

åœ¨æè¿°å¦‚ä½•ä½¿ç”¨å¼€å‘ç¯å¢ƒéš”ç¦»ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹ç›®å‰å¸¸ç”¨çš„å¼€å‘ç¯å¢ƒå…·ä½“çš„åœºæ™¯ï¼Œè¿™é‡Œé€‰äº†ä¸‰ç§å…¸å‹çš„åœºæ™¯ã€‚

**åœºæ™¯ä¸€**<br />æ‰€æœ‰çš„å¼€å‘ç¯å¢ƒéƒ½åœ¨æœ¬åœ°ï¼Œæˆ–è€…è¯´å…¬å¸å†…è‡ªå»ºçš„ IDC ï¼Œè¿™ç±»åœºæ™¯ä¸‹å¼€å‘ç¯å¢ƒçš„æ‰€æœ‰åº”ç”¨éƒ½éƒ¨ç½²åœ¨æœ¬åœ°çš„æœºæˆ¿ã€‚

**åœºæ™¯äºŒ**<br />å…¬å¸é€šè¿‡ä¸“çº¿æ‰“é€šäº†åŠå…¬ç½‘ä¸é˜¿é‡Œäº‘ä¸Šçš„ VPC ï¼Œä¸¤è¾¹çš„ç½‘ç»œå®ç°äº†äº’è”äº’é€šã€‚<br />å¼€å‘ã€æµ‹è¯•ç¯å¢ƒä¸»è¦éƒ¨ç½²åœ¨é˜¿é‡Œäº‘ï¼Œä½†æ˜¯æ­£åœ¨å¼€å‘çš„å·¥ç¨‹ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯è·‘åœ¨æœ¬åœ°åŠå…¬ç½‘çš„ï¼Œç”šè‡³æ˜¯ç›´æ¥è·‘åœ¨å¼€å‘åŒäº‹çš„ä¸ªäººç”µè„‘ä¸Šã€‚

**åœºæ™¯ä¸‰**<br />å…¬å¸å†…å¹¶æ²¡æœ‰ä¸“çº¿æ¥æ‰“é€šäº†åŠå…¬ç½‘ä¸é˜¿é‡Œäº‘ä¸Šçš„ VPCã€‚<br />ä½†æ˜¯å¸Œæœ›èƒ½è®©æœ¬åœ°å¯åŠ¨çš„åº”ç”¨ï¼Œè¿æ¥ä¸Šé˜¿é‡Œäº‘ä¸Šçš„å¼€å‘æµ‹è¯•é›†ç¾¤ï¼Œå¹¶ä¸”å®ç°ç²¾å‡†çš„æµé‡éš”ç¦»ã€‚


é¦–å…ˆè¯´ä¸€ä¸‹ç»“è®ºï¼Œè¿™ä¸Šé¢çš„ä¸‰ä¸ªåœºæ™¯ï¼Œç›®å‰éƒ½æ˜¯å¯ä»¥å®Œæ•´çš„æ”¯æŒçš„ã€‚å…¶ä¸­åœºæ™¯ä¸€å’Œåœºæ™¯äºŒéƒ½ä¸æ¶‰åŠåˆ°ç½‘ç»œæ‰“é€šè¿™éƒ¨åˆ†çš„å†…å®¹ï¼Œå…¶å®åªéœ€è¦æ ¹æ®åŸºæœ¬çš„ MSE æ¥å…¥æ–¹å¼å’Œ MSE æ‰“æ ‡æ–¹å¼å³å¯ç›´æ¥ä½¿ç”¨èµ·æ¥ã€‚<br />åœºæ™¯ä¸‰æ¯”åœºæ™¯ä¸€å’Œåœºæ™¯äºŒå¤šäº†ä¸€ä¸ªç½‘ç»œæ‰“é€šçš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¼šå¤šä¸€ä¸ªç«¯äº‘äº’è”çš„æ­¥éª¤ï¼Œè¿™é‡Œé¢ä¼šè¦æ±‚æ³¨å†Œä¸­å¿ƒéœ€è¦ä½¿ç”¨ MSE æä¾›çš„ Nacosã€‚<br />åœ¨è¿™ä¸ªæœ€ä½³å®è·µä¸­ï¼Œæˆ‘ä»¬ä¼šä»¥åœºæ™¯ä¸‰æ¥å®æ“ã€‚å¦‚æœæ‚¨çš„ä½¿ç”¨åœºæ™¯ä¸æ˜¯åœºæ™¯ä¸‰ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å¿½ç•¥ï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦å…³æ³¨ç«¯äº‘äº’è”ç›¸å…³çš„æ“ä½œã€‚

<a name="xZ6ol"></a>
### ä¸€ å¼€é€š MSE å¾®æœåŠ¡æ²»ç†ä¸“ä¸šç‰ˆ


<a name="nVspD"></a>
#### å¼€é€š  MSE æ²»ç†

ç™»å½•[MSEæ²»ç†ä¸­å¿ƒæ§åˆ¶å°](https://mse.console.aliyun.com/#/msc/home)ï¼Œå¦‚æœæ‚¨å°šæœªå¼€é€š MSE å¾®æœåŠ¡æ²»ç†ï¼Œè¯·æ ¹æ®æç¤ºå¼€é€šä¸“ä¸šç‰ˆã€‚å¦‚æœæ‚¨å·²ç»å¼€é€šäº†MSE å¾®æœåŠ¡æ²»ç†åŸºç¡€ç‰ˆï¼Œè¯·æ ¹æ®æ¦‚è§ˆé¡µä¸­å³ä¾§çš„æç¤ºï¼Œå‡çº§åˆ° ä¸“ä¸šç‰ˆã€‚

<a name="dEvu1"></a>
### äºŒ  å®ŒæˆåŸºçº¿ç¯å¢ƒæ¥å…¥
<a name="BvbAE"></a>
#### 1. æ¥å…¥ MSE æ²»ç†
é¦–å…ˆï¼Œæ‚¨éœ€è¦å°†åŸºçº¿ç¯å¢ƒçš„æ‰€æœ‰åº”ç”¨æ¥å…¥åˆ° MSE ä¸­ï¼Œæ¥å…¥æ–¹å¼ä¸æ‚¨å¼€å‘ç¯å¢ƒä¸­åº”ç”¨éƒ¨ç½²ç¯å¢ƒæœ‰å…³ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡ ACKã€‚æ›´å¤šæ¥å…¥åœºæ™¯è¯·å‚è€ƒ MSE å¸®åŠ©æ–‡æ¡£ [MSE å¾®æœåŠ¡æ²»ç†å¿«é€Ÿå…¥é—¨](https://help.aliyun.com/document_detail/277398.html)ã€‚

1. åœ¨ACKä¸­å®‰è£…MSEæ²»ç†ä¸­å¿ƒç»„ä»¶
   1. ç™»å½•[å®¹å™¨æœåŠ¡æ§åˆ¶å°](https://cs.console.aliyun.com/)ã€‚
   2. åœ¨å·¦ä¾§å¯¼èˆªæ å•å‡»**å¸‚åœº > åº”ç”¨ç›®å½•**ã€‚
   3. åœ¨**åº”ç”¨ç›®å½•**é¡µé¢æœç´¢å¹¶å•å‡»ack-mse-pilotã€‚
   4. åœ¨**ack-mse-pilot**é¡µé¢å³ä¾§**é›†ç¾¤**åˆ—è¡¨ä¸­é€‰æ‹©é›†ç¾¤ï¼Œç„¶åå•å‡»**åˆ›å»º**ã€‚

      ![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2021/png/54319/1637225399935-456b8be9-1a48-436c-a3d0-b11aef7a5579.png#clientId=ucea8df43-288c-4&from=paste&id=ue3f0802b&originHeight=382&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13526&status=done&style=none&taskId=u6076a379-4d3b-4f77-a8a6-f63f538c82c&title=)<br />å®‰è£…MSEå¾®æœåŠ¡æ²»ç†ç»„ä»¶å¤§çº¦éœ€è¦2åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚<br />åˆ›å»ºæˆåŠŸåï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ç›®æ ‡é›†ç¾¤çš„**å‘å¸ƒ**é¡µé¢ï¼Œæ£€æŸ¥å®‰è£…ç»“æœã€‚å¦‚æœå‡ºç°ä»¥ä¸‹é¡µé¢ï¼Œå±•ç¤ºç›¸å…³èµ„æºï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸã€‚

2. ä¸ºACKå‘½åç©ºé—´ä¸­çš„åº”ç”¨å¼€å¯MSEå¾®æœåŠ¡æ²»ç†
   1. ç™»å½•[MSEæ²»ç†ä¸­å¿ƒæ§åˆ¶å°](https://mse.console.aliyun.com/?spm=a2c4g.11186623.2.13.f90a6a60WiEx0N#/msc/home)ã€‚
   2. åœ¨å·¦ä¾§å¯¼èˆªæ é€‰æ‹©**å¾®æœåŠ¡æ²»ç†ä¸­å¿ƒ > K8sé›†ç¾¤åˆ—è¡¨**ã€‚
   3. åœ¨**K8sé›†ç¾¤åˆ—è¡¨**é¡µé¢æœç´¢æ¡†åˆ—è¡¨ä¸­é€‰æ‹©**é›†ç¾¤åç§°**æˆ–**é›†ç¾¤ID**ï¼Œç„¶åè¾“å…¥ç›¸åº”çš„å…³é”®å­—ï¼Œå•å‡» ğŸ” å›¾æ ‡ã€‚
   4. å•å‡»ç›®æ ‡é›†ç¾¤**æ“ä½œ**åˆ—çš„**ç®¡ç†**ã€‚
   5. åœ¨**é›†ç¾¤è¯¦æƒ…**é¡µé¢å‘½åç©ºé—´åˆ—è¡¨åŒºåŸŸï¼Œå•å‡»ç›®æ ‡å‘½åç©ºé—´**æ“ä½œ**åˆ—ä¸‹çš„**å¼€å¯å¾®æœåŠ¡æ²»ç†**ã€‚(å¦‚æœæ‚¨çš„åŸºçº¿ç¯å¢ƒéƒ¨ç½²åœ¨ default è¿™ä¸ª namespace ä¸­ï¼Œåˆ™ç›®æ ‡å‘½åç©ºé—´ä¸º default)
   6. åœ¨**å¼€å¯å¾®æœåŠ¡æ²»ç†**å¯¹è¯æ¡†ä¸­å•å‡»**ç¡®è®¤**
<a name="uON4T"></a>
#### 
<a name="v6K2e"></a>
#### 2. éƒ¨ç½²åŸºçº¿åº”ç”¨
é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ†åˆ«éƒ¨ç½²  spring-cloud-zuulã€spring-cloud-aã€spring-cloud-bã€spring-cloud-c  è¿™å››ä¸ªä¸šåŠ¡åº”ç”¨ï¼Œæ¨¡æ‹Ÿå‡ºä¸€ä¸ªçœŸå®çš„è°ƒç”¨é“¾è·¯ã€‚

	Demo åº”ç”¨çš„ç»“æ„å›¾ä¸‹å›¾ï¼Œåº”ç”¨ä¹‹é—´çš„è°ƒç”¨ï¼Œæ—¢åŒ…å«äº† Spring Cloud çš„è°ƒç”¨ï¼Œä¹ŸåŒ…å«äº† Dubbo çš„è°ƒç”¨ï¼Œè¦†ç›–äº†å½“å‰å¸‚é¢ä¸Šæœ€å¸¸ç”¨çš„ä¸¤ç§å¾®æœåŠ¡æ¡†æ¶ã€‚è¿™äº›åº”ç”¨éƒ½æ˜¯æœ€ç®€å•çš„ Spring Cloud ã€ Dubbo çš„æ ‡å‡†ç”¨æ³•ï¼Œæ‚¨ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ [https://github.com/aliyun/alibabacloud-microservice-demo/tree/master/mse-simple-demo](https://github.com/aliyun/alibabacloud-microservice-demo/tree/master/mse-simple-demo) é¡¹ç›®ä¸ŠæŸ¥çœ‹æºç ã€‚

![æ¶æ„å›¾_4-6-2 ç¬¬å››ç« ç¬¬å…­èŠ‚ç¬¬äºŒå¼ å›¾ .jpg](https://intranetproxy.alipay.com/skylark/lark/0/2022/jpeg/54319/1648132973277-73337f29-e69a-4641-b6c8-0fdaf7d7bc45.jpeg#clientId=ue91281b7-abdd-4&from=ui&id=u8b863f88&originHeight=515&originWidth=3308&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74781&status=done&style=none&taskId=u531c3812-d001-4fa3-9f28-d933bacad6d&title=)

æ‚¨å¯ä»¥ä½¿ç”¨ kubectl æˆ–è€…ç›´æ¥ä½¿ç”¨ ACK æ§åˆ¶å°æ¥éƒ¨ç½²åº”ç”¨ã€‚éƒ¨ç½²æ‰€ä½¿ç”¨çš„ yaml æ–‡ä»¶å¦‚ä¸‹ã€‚<br />æ³¨æ„ï¼Œä¸Šæ–‡ä¸­æåˆ°ï¼Œä½¿ç”¨ç«¯äº‘äº’è”çš„å‰ææ˜¯æ³¨å†Œä¸­å¿ƒä½¿ç”¨çš„æ˜¯ MSE ä¸­çš„ Nacosï¼Œæ‰€ä»¥è¯·æ‚¨åœ¨éƒ¨ç½²ä¹‹å‰ä¿®æ”¹ yaml æ–‡ä»¶ä¸­çš„ spring.cloud.nacos.discovery.server-addr å’Œ dubbo.registry.address ä¸ºæ‚¨è‡ªå·±è´­ä¹°çš„ MSE Nacos åœ°å€ï¼Œå¦åˆ™åº”ç”¨æ˜¯æ— æ³•æ­£å¸¸è¿è¡Œçš„ã€‚è‹¥æ‚¨ä½¿ç”¨çš„æ˜¯ MSE Nacos åŸŸåä¸ºå…¬ç½‘åŸŸåï¼Œè¿˜éœ€è¦ç¡®ä¿å¼€å¯äº†ç™½åå•ã€‚

```yaml
# éƒ¨ç½²ä¸šåŠ¡åº”ç”¨
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-cloud-zuul
spec:
  selector:
    matchLabels:
      app: spring-cloud-zuul
  template:
    metadata:
      annotations:
        msePilotCreateAppName: spring-cloud-zuul
      labels:
        app: spring-cloud-zuul
    spec:
      containers:
        - env:
            - name: JAVA_HOME
              value: /usr/lib/jvm/java-1.8-openjdk/jre
            - name: spring.cloud.nacos.discovery.server-addr
              value: 'mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
          image: registry.cn-shanghai.aliyuncs.com/yizhan/spring-cloud-zuul:1.0.0
          imagePullPolicy: Always
          name: spring-cloud-zuul
          ports:
            - containerPort: 20000

---
apiVersion: v1
kind: Service
metadata:
  annotations:
    service.beta.kubernetes.io/alibaba-cloud-loadbalancer-spec: slb.s1.small
    service.beta.kubernetes.io/alicloud-loadbalancer-address-type: internet
  name: zuul-slb
spec:
  ports:
    - port: 80
      protocol: TCP
      targetPort: 20000
  selector:
    app: spring-cloud-zuul
  type: LoadBalancer
status:
  loadBalancer: {}

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-cloud-a
spec:
  selector:
    matchLabels:
      app: spring-cloud-a
  template:
    metadata:
      annotations:
        msePilotCreateAppName: spring-cloud-a
      labels:
        app: spring-cloud-a
    spec:
      containers:
        - env:
            - name: JAVA_HOME
              value: /usr/lib/jvm/java-1.8-openjdk/jre
            - name: spring.cloud.nacos.discovery.server-addr
              value: 'mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
            - name: dubbo.registry.address
              value: 'nacos://mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
          image: registry.cn-shanghai.aliyuncs.com/yizhan/spring-cloud-a:1.0.0
          imagePullPolicy: Always
          name: spring-cloud-a
          ports:
            - containerPort: 20001
          livenessProbe:
            tcpSocket:
              port: 20001
            initialDelaySeconds: 10
            periodSeconds: 30


---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-cloud-b
spec:
  selector:
    matchLabels:
      app: spring-cloud-b
  template:
    metadata:
      annotations:
        msePilotCreateAppName: spring-cloud-b
      labels:
        app: spring-cloud-b
    spec:
      containers:
        - env:
            - name: JAVA_HOME
              value: /usr/lib/jvm/java-1.8-openjdk/jre
            - name: spring.cloud.nacos.discovery.server-addr
              value: 'mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
            - name: dubbo.registry.address
              value: 'nacos://mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
          image: registry.cn-shanghai.aliyuncs.com/yizhan/spring-cloud-b:1.0.0
          imagePullPolicy: Always
          name: spring-cloud-b
          ports:
            - containerPort: 20002
          livenessProbe:
            tcpSocket:
              port: 20002
            initialDelaySeconds: 10
            periodSeconds: 30

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-cloud-c
spec:
  selector:
    matchLabels:
      app: spring-cloud-c
  template:
    metadata:
      annotations:
        msePilotCreateAppName: spring-cloud-c
      labels:
        app: spring-cloud-c
    spec:
      containers:
        - env:
            - name: JAVA_HOME
              value: /usr/lib/jvm/java-1.8-openjdk/jre
            - name: spring.cloud.nacos.discovery.server-addr
              value: 'mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
            - name: dubbo.registry.address
              value: 'nacos://mse-xxxxxxx-nacos-ans.mse.aliyuncs.com:8848'
          image: registry.cn-shanghai.aliyuncs.com/yizhan/spring-cloud-c:1.0.0
          imagePullPolicy: Always
          name: spring-cloud-c
          ports:
            - containerPort: 20003
          livenessProbe:
            tcpSocket:
              port: 20003
            initialDelaySeconds: 10
            periodSeconds: 30
```
 
<a name="b7jTM"></a>
#### 3. éªŒè¯åŸºçº¿ç¯å¢ƒæ¥å…¥æˆåŠŸ
å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæ‚¨çš„åŸºçº¿ç¯å¢ƒå°±å·²ç»éƒ¨ç½²å¥½äº†ã€‚æ‚¨å¯ä»¥åœ¨ MSE æ§åˆ¶å°ä¸­æ‰¾åˆ°å¯¹åº”çš„ Region æŸ¥çœ‹åº”ç”¨åˆ—è¡¨ï¼Œä»¥åŠåº”ç”¨è¯¦æƒ…é¡µçš„èŠ‚ç‚¹æƒ…å†µã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641370551978-e8f37a81-bf17-4aa3-9049-99485373f931.png#clientId=u92402ae8-cbbb-4&from=paste&height=409&id=MQ0qc&originHeight=818&originWidth=3414&originalType=binary&ratio=1&rotation=0&showTitle=false&size=403125&status=done&style=none&taskId=uf0da5bca-9087-41ab-ab6a-8c18764efa0&title=&width=1707)


åœ¨æœ¬åœ°é…ç½®å¥½ K8s é›†ç¾¤å¯¹åº”çš„ kubeconfig æ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œç»“æœå¦‚ä¸‹
```yaml
âœ  ~ kubectl get svc,deploy
NAME                 TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)        AGE
service/kubernetes   ClusterIP      192.168.0.1     <none>         443/TCP        7d
service/zuul-slb     LoadBalancer   192.168.87.95   47.94.143.53   80:31983/TCP   9m30s

NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/spring-cloud-a      1/1     1            1           9m30s
deployment.apps/spring-cloud-b      1/1     1            1           9m30s
deployment.apps/spring-cloud-c      1/1     1            1           9m30s
deployment.apps/spring-cloud-zuul   1/1     1            1           9m30s
```
åœ¨è¿™é‡Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹ curl  http://47.94.143.53:80/A/a å‘èµ·è°ƒç”¨ï¼Œå¹¶æŸ¥çœ‹è¿”å›ç»“æœ
```yaml
âœ  ~ curl http://47.94.143.53:80/A/a
A[10.242.0.90] -> B[10.242.0.91] -> C[10.242.0.152]%
```
<a name="aa3l2"></a>
### 
<a name="CAQfc"></a>
### ä¸‰  IDEA å¯åŠ¨çš„åº”ç”¨æ¥å…¥ feature ç¯å¢ƒ

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•åœ¨ç½‘ç»œæ²¡æœ‰æ‰“é€šçš„æƒ…å†µä¸‹ï¼Œå°†ä½ æœ¬æœºå¯åŠ¨çš„åº”ç”¨æ¥å…¥åˆ° feature ç¯å¢ƒã€‚é¦–å…ˆæ‚¨éœ€è¦å°†æ‚¨ K8s é›†ç¾¤çš„ kubeconfig æ–‡ä»¶ä¿å­˜åˆ°æœ¬æœºï¼Œå¹¶è¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚
<a name="dpjtb"></a>
#### 
<a name="mdCX1"></a>
#### 1. ä¸‹è½½æºç 
æœ¬å·¥ç¨‹æ‰€æœ‰æºç éƒ½åœ¨ [https://github.com/aliyun/alibabacloud-microservice-demo](https://github.com/aliyun/alibabacloud-microservice-demo) ä¸­ï¼Œå°†ä»£ç  git clone åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”æ‰¾åˆ° mse-simple-demo æ–‡ä»¶å¤¹ä¸­çš„ Aã€Bã€Cã€gateway å››ä¸ªåº”ç”¨ï¼Œå°±æ˜¯æœ¬æ¬¡æœ€ä½³å®è·µæ‰€ä½¿ç”¨çš„å…¬æµ‹ã€‚
<a name="rxs1G"></a>
#### 
<a name="U6S2L"></a>
#### 2. å®‰è£… CloudToolkit æ’ä»¶
å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Cloud Toolkitï¼Œå®‰è£…è¯¦æƒ…è¯·å‚è€ƒå®˜ç½‘ [https://www.aliyun.com/product/cloudtoolkit](https://www.aliyun.com/product/cloudtoolkit)ã€‚

<a name="RGZLs"></a>
#### 3. å¡«å†™é˜¿é‡Œäº‘ AKã€SK
ç”±äºä½¿ç”¨ç«¯äº‘äº’è”åŠŸèƒ½çš„æ—¶å€™ï¼Œéœ€è¦è®¿é—®æ‚¨ MSE çš„èµ„æºï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æ‚¨å¡«å†™æ‚¨çš„ AKã€SKï¼Œå¹¶ç¡®ä¿æ­¤ AKã€SKæ‹¥æœ‰è®¿é—® MSE èµ„æºçš„æƒé™ã€‚<br />ç‚¹å‡» IDEA çš„ **Tools** ä¸­æ‰¾åˆ° **Preference** ï¼Œæ‰¾åˆ° **Alibaba Cloud Toolkit **ä¸­ **Accounts** ï¼Œé…ç½® Access Key ID å’Œ Access Key Secret ä¿¡æ¯ï¼Œå¹¶ç‚¹å‡»ä¿å­˜ã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641374899698-25640370-36e1-41c0-8c46-4fb34a1f3937.png#clientId=u52a028a7-bec8-4&from=paste&height=392&id=p2htT&originHeight=784&originWidth=2326&originalType=binary&ratio=1&rotation=0&showTitle=false&size=516079&status=done&style=none&taskId=u7e8f56b3-b7df-4dd3-a1b6-c3f7251b6fe&title=&width=1163)<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641371194368-1d0b54f3-305a-4110-bc45-296940e8c4cd.png#clientId=u92402ae8-cbbb-4&from=paste&height=708&id=bU3YU&originHeight=1416&originWidth=1964&originalType=binary&ratio=1&rotation=0&showTitle=false&size=582367&status=done&style=none&taskId=ub446f650-b333-4b8a-8ef5-1b94006ce88&title=&width=982)
<a name="avibi"></a>
#### 4. é…ç½® MSE å‚æ•°

ç‚¹å‡» IDEA çš„ **Tools** ä¸­æ‰¾åˆ° **Preference** ï¼Œæ‰¾åˆ° **Alibaba Cloud Toolkit **ä¸­ **Microservice** ä¸‹çš„ **MSE** ï¼Œç‚¹å‡» **å¼€å¯å¾®æœåŠ¡æ²»ç†**ï¼Œå¹¶å®‰è£…ä¸‹å›¾çš„æ–¹å¼è¿›è¡Œé…ç½®å³å¯ã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641371375176-19d09a8d-843d-44dc-8e7d-f33d884e3dc6.png#clientId=u92402ae8-cbbb-4&from=paste&height=708&id=QFENt&originHeight=1416&originWidth=1964&originalType=binary&ratio=1&rotation=0&showTitle=false&size=617769&status=done&style=none&taskId=u70a8823f-8672-4fea-9420-ee8a6aeb050&title=&width=982)<br />**å¯¹å›¾ä¸­çš„å‡ ä¸ªå‚æ•°åšä¸€ä¸‹è¯´æ˜**

1. **LicenseKey**

æ‚¨é˜¿é‡Œäº‘è´¦å·å¯¹åº”çš„ MSE äº§å“çš„ LicenseKey ï¼Œè¯·åœ¨[https://mse.console.aliyun.com/#/msc/app/accessType](https://mse.console.aliyun.com/#/msc/app/accessType)  ä¸­çš„é€‰æ‹© ECS é›†ç¾¤ï¼Œåœ¨ **å®‰è£… MSE Agent** ç« èŠ‚æ‰¾åˆ° LicenseKey çš„å€¼ã€‚<br />æ³¨æ„ï¼šè¯·æ‚¨åšå¥½ LicenseKey çš„ä¿å¯†å·¥ä½œã€‚<br />æ³¨æ„ï¼šå„ä¸ª Region çš„ LicenseKey å€¼å¯èƒ½ä¸ä¸€è‡´ï¼Œè¯·é€‰æ‹©å¯¹åº”çš„ Regionï¼Œå¹¶å’ŒåŸºçº¿ç¯å¢ƒæ¥å…¥çš„ Region ä¿æŒä¸€è‡´ã€‚

2. **App Name**

åº”ç”¨åœ¨æ¥å…¥ MSE æ—¶æ‰€ä½¿ç”¨çš„åº”ç”¨åï¼Œè¯·æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè¿›è¡Œé…ç½®ï¼Œæ³¨æ„è¿™ä¸ªå€¼éœ€è¦å’Œæœ¬æ¬¡æ‰€å¯åŠ¨çš„åº”ç”¨ä¿æŒä¸€è‡´ã€‚

3. **Tag**

æ­¤åº”ç”¨æ‰€å±çš„ç¯å¢ƒ Tagï¼ŒåŸºçº¿ä¸ç”¨å¡«ï¼Œå…¶ä»–è¯·æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè¿›è¡Œå¡«å†™ã€‚å¦‚æœæ­¤åº”ç”¨å±äº feature1 ç¯å¢ƒï¼Œè¯·å¡«å†™ feature1ã€‚

4. **Agent åœ°å€**

é€‰æ‹©è‡ªå·±åº”ç”¨æ‰€åœ¨çš„åœ°åŸŸï¼Œéœ€è¦å’Œ LienseKey æ‰€åœ¨çš„åœ°åŸŸã€ä»¥åŠåŸºçº¿ç¯å¢ƒæ¥å…¥çš„åœ°åŸŸ éƒ½ä¿æŒä¸€è‡´ã€‚

5. **å¼€å¯ RPC ç°åº¦  âœ…**

æ”¯æŒå¯¹ Spring Cloud å’Œ Dubbo è¿‘5å¹´å†…çš„æ‰€æœ‰ç‰ˆæœ¬çš„æµé‡è¿›è¡Œç²¾å‡†æ§åˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹è¯·å¼€å¯ï¼Œé™¤éæ‚¨æ˜ç¡®çŸ¥é“å…³é—­æ­¤é€‰é¡¹çš„ä½¿ç”¨åœºæ™¯ï¼Œå¦åˆ™è¯·å‹¿å…³é—­æ­¤é€‰é¡¹ã€‚

6. **å¼€å¯æ ‡ç­¾æŸ“è‰²  âœ…**

æ¨èå¼€å¯ï¼Œå¼€å¯åç»è¿‡æ­¤åº”ç”¨çš„æµé‡å°±åªä¼šåœ¨å¯¹åº”çš„ Tag ç¯å¢ƒä¸­æµè½¬ã€‚

7. **å¼€å¯æ¶ˆæ¯ç°åº¦  âœ…**

è¯·æ ¹æ®ä¸šåŠ¡å®é™…æƒ…å†µé€‰æ‹©æ˜¯å¦å¼€å¯ï¼Œç›®å‰ä»…æ”¯æŒ RocketMQ 4.5 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚æ›´å¤šæ¶ˆæ¯ç°åº¦ç›¸å…³çš„ä¿¡æ¯ï¼Œè¯·å‚è€ƒå…¨é“¾è·¯ç°åº¦ï¼Œæ¶ˆæ¯éƒ¨åˆ†ã€‚

<a name="GGkn4"></a>
#### 5. é…ç½®ç«¯äº‘äº’è”å‚æ•°
æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨ç½‘ç»œæœªæ‰“é€šçš„æ—¶å€™ï¼Œè”é€šæœ¬æœºç¯å¢ƒå’Œäº‘ä¸Š K8s é›†ç¾¤éœ€è¦ä½¿ç”¨ ç«¯äº‘äº’è”åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹ç«¯äº‘äº’è”ã€‚<br />é¦–å…ˆéœ€è¦é…ç½®ä¸€ä¸‹ä»£ç†æ¨¡å¼ä¸º K8sï¼Œç‚¹å‡» IDEA çš„ **Tools** ä¸­æ‰¾åˆ° **Preference** ï¼Œæ‰¾åˆ° **Alibaba Cloud Toolkit **ä¸­ **Microservice** ä¸‹çš„ **Proxy** ï¼Œç‚¹å‡» **AddProfile **å¢åŠ ä¸€ä¸ªåç§°ä¸º k8s çš„ä»£ç†ã€‚ç„¶åç‚¹å‡»å³ä¾§çš„ **Add** æŒ‰é’®ï¼Œé€‰æ‹©**ä»£ç†ç±»å‹ **ä¸º Kubernetesï¼Œå¹¶é€‰æ‹©æ­£ç¡®çš„** é…ç½®æ–‡ä»¶åœ°å€** å’Œ **å‘½åç©ºé—´**ã€‚![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641371737460-ea4a8c7a-7eb6-4785-aa51-801fc66cd560.png#clientId=u92402ae8-cbbb-4&from=paste&height=708&id=QSYks&originHeight=1416&originWidth=1964&originalType=binary&ratio=1&rotation=0&showTitle=false&size=892009&status=done&style=none&taskId=ue8e62ff0-61df-46fb-af6b-43e1dcf99ad&title=&width=982)<br /> 	ç„¶åï¼Œç‚¹å‡» IDEA çš„ **Tools** ä¸­æ‰¾åˆ° **Preference** ï¼Œæ‰¾åˆ° **Alibaba Cloud Toolkit **ä¸­ **Microservice** ä¸‹çš„ **MicroService** ï¼Œæ‰¾åˆ° **ç«¯äº‘äº’è”** åŠŸèƒ½æ‰“ âœ…ã€‚é€‰æ‹©äº§å“ä¸º **å¾®æœåŠ¡å¼•æ“ MSE**ï¼Œå¹¶é€‰æ‹©ä¸ä¸Šé¢éƒ¨ç½²æ—¶ä¸€è‡´çš„ **Region** ã€ **å®ä¾‹** å’Œ **å‘½åç©ºé—´** ï¼Œä»£ç†é€‰æ‹©åˆšåˆšé…ç½®å¥½çš„ **k8s**ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨æ˜¯ Spring Cloud åº”ç”¨ï¼Œè¿˜å¿…é¡»åœ¨  **æœ¬åœ° Spring Cloud æœåŠ¡ç«¯å£**ä¸­ é…ç½® Tomcat çš„å¯åŠ¨ç«¯å£ã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641371923502-7d334e10-aa47-43cb-9728-f026202dd36a.png#clientId=u92402ae8-cbbb-4&from=paste&height=708&id=DwXtc&originHeight=1416&originWidth=1964&originalType=binary&ratio=1&rotation=0&showTitle=false&size=970492&status=done&style=none&taskId=u79c70c08-6008-4925-9b91-9b5ed4bb245&title=&width=982)<br /> 
<a name="KC79L"></a>
### å›› å¯åŠ¨åº”ç”¨ï¼Œè½»æ¾å¼€å§‹è”è°ƒå’Œæµ‹è¯•

<a name="TUAIo"></a>
#### 1. éªŒè¯æ¥å…¥æˆåŠŸ
å®Œæˆä¸Šè¿°é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å¯åŠ¨åº”ç”¨ã€‚é¦–å…ˆï¼Œå¯åŠ¨åº”ç”¨çš„æ—¶å€™ï¼Œæ‚¨ä¼šçœ‹åˆ°è¿™ä¸¤ä¸ªæç¤ºï¼Œè¯æ˜ç«¯äº‘äº’è”åŠŸèƒ½å·²ç»ç”Ÿæ•ˆã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641372220843-f96c8300-c06d-4bf2-a42a-81b8bdc46c19.png#clientId=u92402ae8-cbbb-4&from=paste&height=141&id=YXncV&originHeight=282&originWidth=740&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64402&status=done&style=none&taskId=u150cdbb4-b6fa-4a97-a32c-2f91df702b7&title=&width=370)![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641372445060-8be06c8f-1ff0-4eab-858e-3776b0d8d3f7.png#clientId=u92402ae8-cbbb-4&from=paste&height=73&id=Q7MOG&originHeight=146&originWidth=784&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33421&status=done&style=none&taskId=u81bf50b3-c679-4d56-90ce-6981bc71f35&title=&width=392)<br />åŒæ—¶ä¸ºäº†éªŒè¯ MSE å¾®æœåŠ¡æ²»ç†æ˜¯å¦æ¥å…¥æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥ç™»å½• MSE æ§åˆ¶å°çš„åº”ç”¨åˆ—è¡¨ç•Œé¢è¿›è¡ŒæŸ¥çœ‹ã€‚åœ¨æ§åˆ¶å°ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘çš„æœ¬æœºåº”ç”¨å·²ç»æˆåŠŸæ¥å…¥åˆ° MSE ï¼Œå¹¶ä¸”æˆåŠŸæ‰“ä¸Šäº† feature1 çš„æ ‡ç­¾ã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641372744971-d2ef6dd2-0ec5-43e3-a2bf-aaa8656b433d.png#clientId=u92402ae8-cbbb-4&from=paste&height=952&id=tp7nk&originHeight=1904&originWidth=3420&originalType=binary&ratio=1&rotation=0&showTitle=false&size=921369&status=done&style=none&taskId=u908f94c3-271c-4d6d-8e6d-ba40a54ee4d&title=&width=1710)


<a name="y3fqH"></a>
#### 2. å‘èµ·æµé‡è°ƒç”¨
å‡è®¾æˆ‘ä»¬å‘å¾€ç½‘å…³çš„è¯·æ±‚æ˜¯ http è¯·æ±‚ï¼Œå¸Œæœ›è¿™ä¸ªè¯·æ±‚å† feature1 ä¸­å®Œæˆé—­ç¯ï¼Œåªéœ€è¦åœ¨è¯·æ±‚çš„ header ä¸­æ·»åŠ  x-mse-tag=feature1 å³å¯ï¼Œæµé‡ä¼šè‡ªåŠ¨åœ¨ feature1 ç¯å¢ƒå†…å®Œæˆé—­ç¯ã€‚æ³¨æ„è¿™é‡Œçš„ key ä¸º x-mse-tag ä¸ºå›ºå®šå€¼ï¼Œfeature1 åˆ™éœ€è¦å’Œç¯å¢ƒçš„æ ‡ç­¾(å³ä¸Šæ–‡ä¸­é…ç½®çš„ alicloud.service.tag)ä¿æŒä¸€è‡´ã€‚<br />å¦‚æœæ‚¨çš„è¯·æ±‚æ¥æºä¸º Dubboï¼Œåˆ™éœ€è¦åœ¨ RpcContext ä¸­å¢åŠ  Attachment ï¼Œå†…å®¹ä¹Ÿæ˜¯ x-mse-tag=feature1ã€‚
```yaml
âœ  ~ curl http://47.94.143.53:80/A/a
A[10.242.0.90] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl http://47.94.143.53:80/A/a
A[10.242.0.90] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl -H"x-mse-tag:feature1" http://47.94.143.53:80/A/a
Afeature1[xx.xxx.12.118] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl -H"x-mse-tag:feature1" http://47.94.143.53:80/A/a
Afeature1[xx.xxx.12.118] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl -H"x-mse-tag:feature1" http://47.94.143.53:80/A/a
Afeature1[xx.xxx.12.118] -> B[10.242.0.91] -> C[10.242.0.152]%
```
å¦‚æœæ‚¨ä¸æ–¹ä¾¿åœ¨è¯·æ±‚ä¸­å¢åŠ  header çš„è¯ï¼Œè¿˜å¯ä»¥åœ¨ MSE æ§åˆ¶å°é…ç½®è§„åˆ™ï¼Œæ¯”å¦‚è®¾ç½®æˆ name=xiaohong æˆ– xiaohua çš„æµé‡è¿›å…¥åˆ° feature1 ç¯å¢ƒã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2022/png/54319/1641373987989-b94330ee-198b-4de0-9571-497ff37f2d85.png#clientId=u92402ae8-cbbb-4&from=paste&height=1010&id=zWevW&originHeight=2020&originWidth=3424&originalType=binary&ratio=1&rotation=0&showTitle=false&size=873306&status=done&style=none&taskId=ua5dba94b-6148-4eb6-88a5-9d6eab2c9e2&title=&width=1712)

å¼€å¯æµé‡è§„åˆ™ä¹‹åï¼Œæˆ‘ä»¬ç»§ç»­éªŒè¯ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ»¡è¶³æ¡ä»¶çš„è¯·æ±‚ä¼šè¢«è½¬å‘åˆ° feature1 ç¯å¢ƒã€‚
```yaml
âœ  ~ curl http://47.94.143.53:80/A/a
A[10.242.0.90] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl http://47.94.143.53:80/A/a\?name\=xiaohong
Afeature1[30.225.12.118] -> B[10.242.0.91] -> C[10.242.0.152]%
âœ  ~ curl http://47.94.143.53:80/A/a\?name\=xiaohua
Afeature1[30.225.12.118] -> B[10.242.0.91] -> C[10.242.0.152]%
```

ç‰¹åˆ«åœ°ï¼Œå¦‚æœæ‚¨çš„ç½‘å…³åº”ç”¨ä¸å±äº Java ä½“ç³»ï¼Œåˆ™éœ€è¦åœ¨ç½‘å…³å±‚é…ç½®ä¸€ä¸‹è§„åˆ™ï¼Œç›®å‰å·²ç»æ”¯æŒ MSEäº‘åŸç”Ÿç½‘å…³ï¼ŒNginxï¼ŒK8s Ingress ç­‰ï¼Œè¯¦ç»†çš„æ¥å…¥æ–¹å¼å¯ä»¥å‚è€ƒ [MSE å…¨é“¾è·¯ç°åº¦é…ç½®]() ã€‚
